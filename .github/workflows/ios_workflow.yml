name: Ios workflow

on:
  workflow_call:

jobs:
  e2e:
    name: Integration test
    strategy:
      matrix:
        device: [ iPhone 11 Pro Max Simulator (15.2) ]
      fail-fast: false
    runs-on: macos-latest
    steps:
      - name: List all simulators
        env:
          PROJECT_ID: ${{secrets.PROJECT_D}}
        run: echo $PROJECT_ID
      - run: xcrun xctrace list devices
      - name: Start Simulator
        run: |
          UDID=$(xcrun xctrace list devices | grep "^${{ matrix.device }}" | awk '{gsub(/[()]/,""); print $NF}')
          echo $UDID
          xcrun simctl boot "${UDID:?No Simulator with this name found}"
      - uses: actions/checkout@v3
      - uses: subosito/flutter-action@v2
        with:
          channel: stable
      - run: flutter channel beta
      - run: flutter upgrade
      - run: flutter pub get
      - run: flutter config --enable-ios
      - run: flutter create .
      - name: Run integration tests
        run: flutter drive --driver=test/test_driver/integration_test.dart --target=test/integration_test/app_test.dart

  build:
    needs: e2e
    name: Build Flutter App
    runs-on: macos-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - uses: subosito/flutter-action@v2
        with:
          channel: 'stable'
      - name: Get dependencies
        run: flutter channel beta
      - run: flutter upgrade
      - run: flutter pub get
      - run: flutter config --enable-ios
      - run: flutter create .
      - name: Install the Apple certificate and provisioning profile
        env:
          BUILD_CERTIFICATE_BASE64: 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
          P12_PASSWORD: admin
          BUILD_PROVISION_PROFILE_BASE64: MII1nwYJKoZIhvcNAQcCoII1kDCCNYwCAQExCzAJBgUrDgMCGgUAMIIlrAYJKoZIhvcNAQcBoIIlnQSCJZk8P3htbCB2ZXJzaW9uPSIxLjAiIGVuY29kaW5nPSJVVEYtOCI/Pgo8IURPQ1RZUEUgcGxpc3QgUFVCTElDICItLy9BcHBsZS8vRFREIFBMSVNUIDEuMC8vRU4iICJodHRwOi8vd3d3LmFwcGxlLmNvbS9EVERzL1Byb3BlcnR5TGlzdC0xLjAuZHRkIj4KPHBsaXN0IHZlcnNpb249IjEuMCI+CjxkaWN0PgoJPGtleT5BcHBJRE5hbWU8L2tleT4KCTxzdHJpbmc+Q2FydGVyIHRlc3Q8L3N0cmluZz4KCTxrZXk+QXBwbGljYXRpb25JZGVudGlmaWVyUHJlZml4PC9rZXk+Cgk8YXJyYXk+Cgk8c3RyaW5nPjQ1NDhOV0ZUTjg8L3N0cmluZz4KCTwvYXJyYXk+Cgk8a2V5PkNyZWF0aW9uRGF0ZTwva2V5PgoJPGRhdGU+MjAyMi0xMC0xM1QyMzowNDo1MVo8L2RhdGU+Cgk8a2V5PlBsYXRmb3JtPC9rZXk+Cgk8YXJyYXk+CgkJPHN0cmluZz5pT1M8L3N0cmluZz4KCTwvYXJyYXk+Cgk8a2V5PklzWGNvZGVNYW5hZ2VkPC9rZXk+Cgk8ZmFsc2UvPgoJPGtleT5EZXZlbG9wZXJDZXJ0aWZpY2F0ZXM8L2tleT4KCTxhcnJheT4KCQk8ZGF0YT5NSUlGeURDQ0JMQ2dBd0lCQWdJUVZOdTRyaVFVU2RqMi9SL1hMWDN5c2pBTkJna3Foa2lHOXcwQkFRc0ZBREIxTVVRd1FnWURWUVFERER0QmNIQnNaU0JYYjNKc1pIZHBaR1VnUkdWMlpXeHZjR1Z5SUZKbGJHRjBhVzl1Y3lCRFpYSjBhV1pwWTJGMGFXOXVJRUYxZEdodmNtbDBlVEVMTUFrR0ExVUVDd3dDUnpNeEV6QVJCZ05WQkFvTUNrRndjR3hsSUVsdVl5NHhDekFKQmdOVkJBWVRBbFZUTUI0WERUSXlNVEF4TXpJeU16QXlNVm9YRFRJek1UQXhNekl5TXpBeU1Gb3dnWTR4R2pBWUJnb0praWFKay9Jc1pBRUJEQW8wV1VOWU9GTTJWemhYTVRJd01BWURWUVFERENsQmNIQnNaU0JFWlhabGJHOXdiV1Z1ZERvZ1NtOWxiQ0JYWVdKdklDaEtURE0wUXpSUk9UYzBLVEVUTUJFR0ExVUVDd3dLTkRVME9FNVhSbFJPT0RFYU1CZ0dBMVVFQ2d3UlJHRnVhV2hsYkNCSGNtOTFjQ0JKYm1NeEN6QUpCZ05WQkFZVEFsVlRNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQTZhWUJRaitSemNocDFIek5GOTJoZmhtTUxjeEtzbzV5eGxlSSszaXdqaHlTeFc4Z2lVZmFpRGJ6SVVWdWZMd0I4aU9UUDExWWYxcTFybnQ5SXQzdGlYSXFnWVNGeCtVUDN0VnJVNTcycVEreWVWcm5yUjVzNkdieGs1OFhvdlNab053YzA3aS85QlBXbEhvem0rT0VPZnQzTE9tbk9xRjlWUXBxWU5yZnRacUdMRTk0NnZXNlNaYjBiMEdobnh1dlJWSmduUzNYQ2RyVlRadGl5UGRlR0VsaGY4bWJSMWlBeFVaQ0laRHlBRjAvVXQvNDJuV3I2TjZ3QXNPd1A2RFQ4SklJREhrRzVSSVNpbi9yNjRoNFJ1a3plUDJVT04rTEd2eU4zM2RJUUhzTi9VOGZHQTVlT0VtbEpMbXIvTmZ4TDVtNFBWWkU1cFA3c1crTnkxVHBpd0lEQVFBQm80SUNPRENDQWpRd0RBWURWUjBUQVFIL0JBSXdBREFmQmdOVkhTTUVHREFXZ0JRSi9zQVZrUG12WkFxU0Vya21LR01NbCt5bnNqQndCZ2dyQmdFRkJRY0JBUVJrTUdJd0xRWUlLd1lCQlFVSE1BS0dJV2gwZEhBNkx5OWpaWEowY3k1aGNIQnNaUzVqYjIwdmQzZGtjbWN6TG1SbGNqQXhCZ2dyQmdFRkJRY3dBWVlsYUhSMGNEb3ZMMjlqYzNBdVlYQndiR1V1WTI5dEwyOWpjM0F3TXkxM2QyUnlaek13TkRDQ0FSNEdBMVVkSUFTQ0FSVXdnZ0VSTUlJQkRRWUpLb1pJaHZkalpBVUJNSUgvTUlIREJnZ3JCZ0VGQlFjQ0FqQ0J0Z3lCczFKbGJHbGhibU5sSUc5dUlIUm9hWE1nWTJWeWRHbG1hV05oZEdVZ1lua2dZVzU1SUhCaGNuUjVJR0Z6YzNWdFpYTWdZV05qWlhCMFlXNWpaU0J2WmlCMGFHVWdkR2hsYmlCaGNIQnNhV05oWW14bElITjBZVzVrWVhKa0lIUmxjbTF6SUdGdVpDQmpiMjVrYVhScGIyNXpJRzltSUhWelpTd2dZMlZ5ZEdsbWFXTmhkR1VnY0c5c2FXTjVJR0Z1WkNCalpYSjBhV1pwWTJGMGFXOXVJSEJ5WVdOMGFXTmxJSE4wWVhSbGJXVnVkSE11TURjR0NDc0dBUVVGQndJQkZpdG9kSFJ3Y3pvdkwzZDNkeTVoY0hCc1pTNWpiMjB2WTJWeWRHbG1hV05oZEdWaGRYUm9iM0pwZEhrdk1CWUdBMVVkSlFFQi93UU1NQW9HQ0NzR0FRVUZCd01ETUIwR0ExVWREZ1FXQkJTTGRLRTFzV1NxcS9DL0V3V0NBV1plUXVLVnFEQU9CZ05WSFE4QkFmOEVCQU1DQjRBd0V3WUtLb1pJaHZkalpBWUJBZ0VCL3dRQ0JRQXdFd1lLS29aSWh2ZGpaQVlCREFFQi93UUNCUUF3RFFZSktvWklodmNOQVFFTEJRQURnZ0VCQUMvVnVMZmVmNkNxUzJMVWpHSU1oZ3JQZ0prWTBMUVBQUkZjd1F0UW1VenVjVlRZWks2bm1LcjdROUpWc0lOOG1WK29VS0NFcDJ0ekN6dGxYb3MxQi9CY0lMM0R3ZW1nU1d5VWs3UFlpRnhLQ3dDTDBaRTE3VWl1UUV0T2d0YlN2RUdjOVVBNDZIVjkrb1VlcHZjeXo1eTUwK1h2VUN4M0ZYRHovd25KQWhQVlZJdTRTVlU5MEVxcW55UEEvQmFkaDhDK25paFl2VjdmTUZEa3dCT3pLWUJ1dStJRVlYKzh6anBDa25vZmNmYk12RDFtQ0VNNDFhY2pHTytaY2NrdVMwazFXbHFhRkN3TUtyazl2NTYxUzZSSlV5TVNDSVNjSm9YM1gwUXdrcGtIUTJMZCtvc3VVRUlYR1BNQTNIRS94SUdPWFpsbnRCMStpYVAvYUhsOEp5RT08L2RhdGE+Cgk8L2FycmF5PgoKCTxrZXk+REVSLUVuY29kZWQtUHJvZmlsZTwva2V5PgoJPGRhdGE+TUlJUFBnWUpLb1pJaHZjTkFRY0NvSUlQTHpDQ0R5c0NBUUV4RHpBTkJnbGdoa2dCWlFNRUFnRUZBRENDQlBnR0NTcUdTSWIzRFFFSEFhQ0NCT2tFZ2dUbE1ZSUU0VEFNREFkV1pYSnphVzl1QWdFQk1CQU1DbFJwYldWVWIweHBkbVVDQWdGdE1CRU1DRkJzWVhSbWIzSnRNQVVNQTJsUFV6QVREQVJPWVcxbERBdERZWEowWlhKZmRHVnpkREFUREE1SmMxaGpiMlJsVFdGdVlXZGxaQUVCQURBWURBbEJjSEJKUkU1aGJXVU1DME5oY25SbGNpQjBaWE4wTUIwTUNGUmxZVzFPWVcxbERCRkVZVzVwYUdWc0lFZHliM1Z3SUVsdVl6QWREQXhEY21WaGRHbHZia1JoZEdVWERUSXlNVEF4TXpJek1EUTFNVm93SGd3T1ZHVmhiVWxrWlc1MGFXWnBaWEl3REF3S05EVTBPRTVYUmxST09EQWZEQTVGZUhCcGNtRjBhVzl1UkdGMFpSY05Nak14TURFek1qTXdORFV4V2pBaURCZFFjbTltYVd4bFJHbHpkSEpwWW5WMGFXOXVWSGx3WlF3SFRFbE5TVlJGUkRBckRCdEJjSEJzYVdOaGRHbHZia2xrWlc1MGFXWnBaWEpRY21WbWFYZ3dEQXdLTkRVME9FNVhSbFJPT0RBc0RBUlZWVWxFRENSaE0ySTRZakV5TlMwME1Ua3dMVFEwTVRZdFlUTXhPUzFrWkdNMVpEZGtPVFZpWW1Rd01Rd1NVSEp2ZG1semFXOXVaV1JFWlhacFkyVnpNQnNNR1RBd01EQTRNRE13TFRBd01ESTNNREkwTXpZM09UZ3dNa1V3T3d3VlJHVjJaV3h2Y0dWeVEyVnlkR2xtYVdOaGRHVnpNQ0lFSUJYbDZTckpHSzdXTXo4cCtqSllGUnFpaXlNdnFwWGJNaitIZGlSRE5FUFpNSUlDK0F3TVJXNTBhWFJzWlcxbGJuUnpjSUlDNWdJQkFiQ0NBdDh3UFF3V1lYQndiR2xqWVhScGIyNHRhV1JsYm5ScFptbGxjZ3dqTkRVME9FNVhSbFJPT0M1amIyMHVaWGhoYlhCc1pTNWpZWEowWlVOeWJWUmxjM1F3UlF3b1kyOXRMbUZ3Y0d4bExtUmxkbVZzYjNCbGNpNURiR0Z6YzB0cGRDMWxiblpwY205dWJXVnVkREFaREFwd2NtOWtkV04wYVc5dURBdGtaWFpsYkc5d2JXVnVkREFyRENaamIyMHVZWEJ3YkdVdVpHVjJaV3h2Y0dWeUxtRnpjMjlqYVdGMFpXUXRaRzl0WVdsdWN3d0JLakJOREVoamIyMHVZWEJ3YkdVdVpHVjJaV3h2Y0dWeUxtRjFkR2hsYm5ScFkyRjBhVzl1TFhObGNuWnBZMlZ6TG1GMWRHOW1hV3hzTFdOeVpXUmxiblJwWVd3dGNISnZkbWxrWlhJQkFmOHdSd3dyWTI5dExtRndjR3hsTG1SbGRtVnNiM0JsY2k1a1pXWmhkV3gwTFdSaGRHRXRjSEp2ZEdWamRHbHZiZ3dZVGxOR2FXeGxVSEp2ZEdWamRHbHZia052YlhCc1pYUmxNRklNTldOdmJTNWhjSEJzWlM1a1pYWmxiRzl3WlhJdVpHVjJhV05sWTJobFkyc3VZWEJ3WVhSMFpYTjBMV1Z1ZG1seWIyNXRaVzUwTUJrTUMyUmxkbVZzYjNCdFpXNTBEQXB3Y205a2RXTjBhVzl1TUNjTUkyTnZiUzVoY0hCc1pTNWtaWFpsYkc5d1pYSXVhVzR0WVhCd0xYQmhlVzFsYm5Sek1BQXdMUXdvWTI5dExtRndjR3hsTG1SbGRtVnNiM0JsY2k1dVpYUjNiM0pyYVc1bkxuZHBabWt0YVc1bWJ3RUIvekF4RENOamIyMHVZWEJ3YkdVdVpHVjJaV3h2Y0dWeUxuUmxZVzB0YVdSbGJuUnBabWxsY2d3S05EVTBPRTVYUmxST09EQTRERE5qYjIwdVlYQndiR1V1WkdWMlpXeHZjR1Z5TG5WelpYSnViM1JwWm1sallYUnBiMjV6TG1OdmJXMTFibWxqWVhScGIyNEJBZjh3S1F3bFkyOXRMbUZ3Y0d4bExuTmxZM1Z5YVhSNUxtRndjR3hwWTJGMGFXOXVMV2R5YjNWd2N6QUFNQk1NRG1kbGRDMTBZWE5yTFdGc2JHOTNBUUgvTURrTUZtdGxlV05vWVdsdUxXRmpZMlZ6Y3kxbmNtOTFjSE13SHd3TU5EVTBPRTVYUmxST09DNHFEQTlqYjIwdVlYQndiR1V1ZEc5clpXNmdnZ2c4TUlJQ1F6Q0NBY21nQXdJQkFnSUlMY1g4aU5MRlM1VXdDZ1lJS29aSXpqMEVBd013WnpFYk1Ca0dBMVVFQXd3U1FYQndiR1VnVW05dmRDQkRRU0F0SUVjek1TWXdKQVlEVlFRTERCMUJjSEJzWlNCRFpYSjBhV1pwWTJGMGFXOXVJRUYxZEdodmNtbDBlVEVUTUJFR0ExVUVDZ3dLUVhCd2JHVWdTVzVqTGpFTE1Ba0dBMVVFQmhNQ1ZWTXdIaGNOTVRRd05ETXdNVGd4T1RBMldoY05Nemt3TkRNd01UZ3hPVEEyV2pCbk1Sc3dHUVlEVlFRRERCSkJjSEJzWlNCU2IyOTBJRU5CSUMwZ1J6TXhKakFrQmdOVkJBc01IVUZ3Y0d4bElFTmxjblJwWm1sallYUnBiMjRnUVhWMGFHOXlhWFI1TVJNd0VRWURWUVFLREFwQmNIQnNaU0JKYm1NdU1Rc3dDUVlEVlFRR0V3SlZVekIyTUJBR0J5cUdTTTQ5QWdFR0JTdUJCQUFpQTJJQUJKanBMejFBY3FUdGt5SnlnUk1jM1JDVjhjV2pUbkhjRkJiWkR1V21CU3AzWkh0ZlRqalR1eHhFdFgvMUg3WXlZbDNKNllSYlR6QlBFVm9BL1ZoWURLWDFEeXhOQjBjVGRkcVhsNWR2TVZ6dEs1MTdJRHZZdVZUWlhwbWtPbEVLTWFOQ01FQXdIUVlEVlIwT0JCWUVGTHV3M3FGWU00aWFwSXFaM3I2OTY2L2F5eVNyTUE4R0ExVWRFd0VCL3dRRk1BTUJBZjh3RGdZRFZSMFBBUUgvQkFRREFnRUdNQW9HQ0NxR1NNNDlCQU1EQTJnQU1HVUNNUUNENmNIRUZsNGFYVFFZMmUzdjlHd09BRVpMdU4reVJoSEZELzNtZW95aHBtdk93Z1BVblBXVHhuUzRhdCtxSXhVQ01HMW1paERLMUEzVVQ4Mk5RejYwaW1PbE0yN2piZG9YdDJRZnlGTW0rWWhpZERrTEYxdkxVYWdNNkJnRDU2S3lLRENDQXVZd2dnSnRvQU1DQVFJQ0NETU43dmkvVEdndU1Bb0dDQ3FHU000OUJBTURNR2N4R3pBWkJnTlZCQU1NRWtGd2NHeGxJRkp2YjNRZ1EwRWdMU0JITXpFbU1DUUdBMVVFQ3d3ZFFYQndiR1VnUTJWeWRHbG1hV05oZEdsdmJpQkJkWFJvYjNKcGRIa3hFekFSQmdOVkJBb01Da0Z3Y0d4bElFbHVZeTR4Q3pBSkJnTlZCQVlUQWxWVE1CNFhEVEUzTURJeU1qSXlNak15TWxvWERUTXlNREl4T0RBd01EQXdNRm93Y2pFbU1DUUdBMVVFQXd3ZFFYQndiR1VnVTNsemRHVnRJRWx1ZEdWbmNtRjBhVzl1SUVOQklEUXhKakFrQmdOVkJBc01IVUZ3Y0d4bElFTmxjblJwWm1sallYUnBiMjRnUVhWMGFHOXlhWFI1TVJNd0VRWURWUVFLREFwQmNIQnNaU0JKYm1NdU1Rc3dDUVlEVlFRR0V3SlZVekJaTUJNR0J5cUdTTTQ5QWdFR0NDcUdTTTQ5QXdFSEEwSUFCQVpycEZadmZaOG4wYzQyanBJYlZzMVVObVJLeVpSb21mckpJSDdpOVZnUDNPSnE2eGxITHk3dk82UUJ0QUVUUkh4YUpxMmduQ2tsaXVYbUJtOVBmRnFqZ2Zjd2dmUXdEd1lEVlIwVEFRSC9CQVV3QXdFQi96QWZCZ05WSFNNRUdEQVdnQlM3c042aFdET0ltcVNLbWQ2K3ZldXYyc3NrcXpCR0JnZ3JCZ0VGQlFjQkFRUTZNRGd3TmdZSUt3WUJCUVVITUFHR0ttaDBkSEE2THk5dlkzTndMbUZ3Y0d4bExtTnZiUzl2WTNOd01ETXRZWEJ3YkdWeWIyOTBZMkZuTXpBM0JnTlZIUjhFTURBdU1DeWdLcUFvaGlab2RIUndPaTh2WTNKc0xtRndjR3hsTG1OdmJTOWhjSEJzWlhKdmIzUmpZV2N6TG1OeWJEQWRCZ05WSFE0RUZnUVVla2U2T0lvVkpFZ2lSczIranhva2V6UURLbWt3RGdZRFZSMFBBUUgvQkFRREFnRUdNQkFHQ2lxR1NJYjNZMlFHQWhFRUFnVUFNQW9HQ0NxR1NNNDlCQU1EQTJjQU1HUUNNQlVNcVk3R3I1WnBhNmVmM1Z6VUExbHNybExVWU1hTGR1QzN4YUx4Q1h6Z211TnJzZU44TWNRbmVxZU9pZjJyZHdJd1lUTWc4U24vK1ljeXJpbklaRDEyZTFHazBnSXZkcjVnSXBIeDFUcDEzTFRpeGlxVy9zWUozRXBQMVNUdy9NcXlNSUlEQnpDQ0FxMmdBd0lCQWdJSVhoaTlicVIzUU1Bd0NnWUlLb1pJemowRUF3SXdjakVtTUNRR0ExVUVBd3dkUVhCd2JHVWdVM2x6ZEdWdElFbHVkR1ZuY21GMGFXOXVJRU5CSURReEpqQWtCZ05WQkFzTUhVRndjR3hsSUVObGNuUnBabWxqWVhScGIyNGdRWFYwYUc5eWFYUjVNUk13RVFZRFZRUUtEQXBCY0hCc1pTQkpibU11TVFzd0NRWURWUVFHRXdKVlV6QWVGdzB5TWpBMU1Ua3hPVFEzTWpSYUZ3MHlOakEyTVRjeE9UUTNNak5hTUU0eEtqQW9CZ05WQkFNTUlWZFhSRklnVUhKdmRtbHphVzl1YVc1bklGQnliMlpwYkdVZ1UybG5ibWx1WnpFVE1CRUdBMVVFQ2d3S1FYQndiR1VnU1c1akxqRUxNQWtHQTFVRUJoTUNWVk13V1RBVEJnY3Foa2pPUFFJQkJnZ3Foa2pPUFFNQkJ3TkNBQVQrM1Q1ZEV5TWNOZDN2Q0I3ZVhJVjRmUDJxWE1DQlQ3RXB2M2pMVU5TWkkrajBsa3pHWjZKSDUwYWFUMDZZVHliSEE5NDR1cEthZElHVUxKdUtIdE1UbzRJQlR6Q0NBVXN3REFZRFZSMFRBUUgvQkFJd0FEQWZCZ05WSFNNRUdEQVdnQlI2UjdvNGloVWtTQ0pHemI2UEdpUjdOQU1xYVRCQkJnZ3JCZ0VGQlFjQkFRUTFNRE13TVFZSUt3WUJCUVVITUFHR0pXaDBkSEE2THk5dlkzTndMbUZ3Y0d4bExtTnZiUzl2WTNOd01ETXRZWE5wWTJFME1ETXdnWllHQTFVZElBU0JqakNCaXpDQmlBWUpLb1pJaHZkalpBVUJNSHN3ZVFZSUt3WUJCUVVIQWdJd2JReHJWR2hwY3lCalpYSjBhV1pwWTJGMFpTQnBjeUIwYnlCaVpTQjFjMlZrSUdWNFkyeDFjMmwyWld4NUlHWnZjaUJtZFc1amRHbHZibk1nYVc1MFpYSnVZV3dnZEc4Z1FYQndiR1VnVUhKdlpIVmpkSE1nWVc1a0wyOXlJRUZ3Y0d4bElIQnliMk5sYzNObGN5NHdIUVlEVlIwT0JCWUVGQTdoMFpzSjBHNXpCcUdrR3hiMERCMDFJQUhtTUE0R0ExVWREd0VCL3dRRUF3SUhnREFQQmdrcWhraUc5Mk5rREJNRUFnVUFNQW9HQ0NxR1NNNDlCQU1DQTBnQU1FVUNJSGpRWUR6azlTb2g1cWhHa2RwY2NZOTR2TmFnQ1R1ZWhqYXpaVHYzWkJaZkFpRUE5WGVpQkp0T1ROQWcxUzhZVXQyNTFRQXZiWU9DRXpqQ0h3U2FlOWduaEZReGdnSFhNSUlCMHdJQkFUQitNSEl4SmpBa0JnTlZCQU1NSFVGd2NHeGxJRk41YzNSbGJTQkpiblJsWjNKaGRHbHZiaUJEUVNBME1TWXdKQVlEVlFRTERCMUJjSEJzWlNCRFpYSjBhV1pwWTJGMGFXOXVJRUYxZEdodmNtbDBlVEVUTUJFR0ExVUVDZ3dLUVhCd2JHVWdTVzVqTGpFTE1Ba0dBMVVFQmhNQ1ZWTUNDRjRZdlc2a2QwREFNQTBHQ1dDR1NBRmxBd1FDQVFVQW9JSHBNQmdHQ1NxR1NJYjNEUUVKQXpFTEJna3Foa2lHOXcwQkJ3RXdIQVlKS29aSWh2Y05BUWtGTVE4WERUSXlNVEF4TXpJek1EUTFNVm93S2dZSktvWklodmNOQVFrME1SMHdHekFOQmdsZ2hrZ0JaUU1FQWdFRkFLRUtCZ2dxaGtqT1BRUURBakF2QmdrcWhraUc5dzBCQ1FReElnUWdaaGZkNDRyczVJa2VKVWhaUGRmZUx4OTQwZXN1OEIvSk1pWlhybE5Cd3JJd1VnWUpLb1pJaHZjTkFRa1BNVVV3UXpBS0JnZ3Foa2lHOXcwREJ6QU9CZ2dxaGtpRzl3MERBZ0lDQUlBd0RRWUlLb1pJaHZjTkF3SUNBVUF3QndZRkt3NERBZ2N3RFFZSUtvWklodmNOQXdJQ0FTZ3dDZ1lJS29aSXpqMEVBd0lFUnpCRkFpQkRpRHdUTVB5eXlWbk45eDh4MnFPY21FYXN3SXkrdU50ZlRHVE5ldU4yV3dJaEFMNWQ0K3JqcjdSdjJyYUVpc1RGL1pvMjc2TDlMZjdZdThWaG40dXRWUHBUPC9kYXRhPgoJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQoJPGtleT5FbnRpdGxlbWVudHM8L2tleT4KCTxkaWN0PgoJCQkJCgkJCQk8a2V5PmNvbS5hcHBsZS5kZXZlbG9wZXIubmV0d29ya2luZy53aWZpLWluZm88L2tleT4KCQk8dHJ1ZS8+CgkJCQkKCQkJCTxrZXk+Y29tLmFwcGxlLnNlY3VyaXR5LmFwcGxpY2F0aW9uLWdyb3Vwczwva2V5PgoJCTxhcnJheT48L2FycmF5PgoJCQkJCgkJCQk8a2V5PmNvbS5hcHBsZS5kZXZlbG9wZXIuaW4tYXBwLXBheW1lbnRzPC9rZXk+CgkJPGFycmF5PjwvYXJyYXk+CgkJCQkKCQkJCTxrZXk+Y29tLmFwcGxlLmRldmVsb3Blci5hc3NvY2lhdGVkLWRvbWFpbnM8L2tleT4KCQk8c3RyaW5nPio8L3N0cmluZz4KCQkJCQoJCQkJPGtleT5jb20uYXBwbGUuZGV2ZWxvcGVyLmF1dGhlbnRpY2F0aW9uLXNlcnZpY2VzLmF1dG9maWxsLWNyZWRlbnRpYWwtcHJvdmlkZXI8L2tleT4KCQk8dHJ1ZS8+CgkJCQkKCQkJCTxrZXk+Y29tLmFwcGxlLmRldmVsb3Blci5DbGFzc0tpdC1lbnZpcm9ubWVudDwva2V5PgoJCTxhcnJheT4KCQkJCTxzdHJpbmc+cHJvZHVjdGlvbjwvc3RyaW5nPgoJCQkJPHN0cmluZz5kZXZlbG9wbWVudDwvc3RyaW5nPgoJCTwvYXJyYXk+CgkJCQkKCQkJCTxrZXk+Y29tLmFwcGxlLmRldmVsb3Blci5kZWZhdWx0LWRhdGEtcHJvdGVjdGlvbjwva2V5PgoJCTxzdHJpbmc+TlNGaWxlUHJvdGVjdGlvbkNvbXBsZXRlPC9zdHJpbmc+CgkJCQkKCQkJCTxrZXk+YXBwbGljYXRpb24taWRlbnRpZmllcjwva2V5PgoJCTxzdHJpbmc+NDU0OE5XRlROOC5jb20uZXhhbXBsZS5jYXJ0ZUNybVRlc3Q8L3N0cmluZz4KCQkJCQoJCQkJPGtleT5rZXljaGFpbi1hY2Nlc3MtZ3JvdXBzPC9rZXk+CgkJPGFycmF5PgoJCQkJPHN0cmluZz40NTQ4TldGVE44Lio8L3N0cmluZz4KCQkJCTxzdHJpbmc+Y29tLmFwcGxlLnRva2VuPC9zdHJpbmc+CgkJPC9hcnJheT4KCQkJCQoJCQkJPGtleT5nZXQtdGFzay1hbGxvdzwva2V5PgoJCTx0cnVlLz4KCQkJCQoJCQkJPGtleT5jb20uYXBwbGUuZGV2ZWxvcGVyLnRlYW0taWRlbnRpZmllcjwva2V5PgoJCTxzdHJpbmc+NDU0OE5XRlROODwvc3RyaW5nPgoJCQkJCgkJCQk8a2V5PmNvbS5hcHBsZS5kZXZlbG9wZXIudXNlcm5vdGlmaWNhdGlvbnMuY29tbXVuaWNhdGlvbjwva2V5PgoJCTx0cnVlLz4KCQkJCQoJCQkJPGtleT5jb20uYXBwbGUuZGV2ZWxvcGVyLmRldmljZWNoZWNrLmFwcGF0dGVzdC1lbnZpcm9ubWVudDwva2V5PgoJCTxhcnJheT4KCQkJCTxzdHJpbmc+ZGV2ZWxvcG1lbnQ8L3N0cmluZz4KCQkJCTxzdHJpbmc+cHJvZHVjdGlvbjwvc3RyaW5nPgoJCTwvYXJyYXk+CgoJPC9kaWN0PgoJPGtleT5FeHBpcmF0aW9uRGF0ZTwva2V5PgoJPGRhdGU+MjAyMy0xMC0xM1QyMzowNDo1MVo8L2RhdGU+Cgk8a2V5Pk5hbWU8L2tleT4KCTxzdHJpbmc+Q2FydGVyX3Rlc3Q8L3N0cmluZz4KCTxrZXk+UHJvdmlzaW9uZWREZXZpY2VzPC9rZXk+Cgk8YXJyYXk+CgkJPHN0cmluZz4wMDAwODAzMC0wMDAyNzAyNDM2Nzk4MDJFPC9zdHJpbmc+Cgk8L2FycmF5PgoJPGtleT5UZWFtSWRlbnRpZmllcjwva2V5PgoJPGFycmF5PgoJCTxzdHJpbmc+NDU0OE5XRlROODwvc3RyaW5nPgoJPC9hcnJheT4KCTxrZXk+VGVhbU5hbWU8L2tleT4KCTxzdHJpbmc+RGFuaWhlbCBHcm91cCBJbmM8L3N0cmluZz4KCTxrZXk+VGltZVRvTGl2ZTwva2V5PgoJPGludGVnZXI+MzY1PC9pbnRlZ2VyPgoJPGtleT5VVUlEPC9rZXk+Cgk8c3RyaW5nPmEzYjhiMTI1LTQxOTAtNDQxNi1hMzE5LWRkYzVkN2Q5NWJiZDwvc3RyaW5nPgoJPGtleT5WZXJzaW9uPC9rZXk+Cgk8aW50ZWdlcj4xPC9pbnRlZ2VyPgo8L2RpY3Q+CjwvcGxpc3Q+oIINPzCCBDQwggMcoAMCAQICCGPnHCGdGpMnMA0GCSqGSIb3DQEBCwUAMHMxLTArBgNVBAMMJEFwcGxlIGlQaG9uZSBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTEgMB4GA1UECwwXQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkxEzARBgNVBAoMCkFwcGxlIEluYy4xCzAJBgNVBAYTAlVTMB4XDTIyMDMxNzIxMjkxOFoXDTI3MDMxNjIxMjkxN1owWTE1MDMGA1UEAwwsQXBwbGUgaVBob25lIE9TIFByb3Zpc2lvbmluZyBQcm9maWxlIFNpZ25pbmcxEzARBgNVBAoMCkFwcGxlIEluYy4xCzAJBgNVBAYTAlVTMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAvnjmR3QfNeNRKLiYW5H7b7OgpShgV5F5NQpsFKJp2Wnkgxnqs9GBo5EIfrce0KmomPcxRA+dl49zyEFo72oFUfx6c+AZfNay4don6rfLLI/iGHtlmNJhWjwwJDt+CXHpPH6/adTDYhhZwzGKe3fmIrUR40eYt+edjrmqYYGzkPE4TchPrAQl0kecqeboVINgAFq7QCM/IBFtvOMt4aNhPI8/4LBC37/vQBh41JaEef8EcsdSnNh7h+08nAQI2xCJe10uIJm7q/L9VQFo8C60bUJ3z3QEYi50VrObOQOwIjHdCr5CbGHd8qnThepeUial+8pMkcFnDooPi1TyOiFO7QIDAQABo4HlMIHiMAwGA1UdEwEB/wQCMAAwHwYDVR0jBBgwFoAUb/GVGGJc4Mjxxe1sGMng02RSmCAwQAYIKwYBBQUHAQEENDAyMDAGCCsGAQUFBzABhiRodHRwOi8vb2NzcC5hcHBsZS5jb20vb2NzcDAzLWFpcGNhMDcwLwYDVR0fBCgwJjAkoCKgIIYeaHR0cDovL2NybC5hcHBsZS5jb20vYWlwY2EuY3JsMB0GA1UdDgQWBBRuqPK1KTk5L9f2j4aq1Ia3DmLXPDAOBgNVHQ8BAf8EBAMCB4AwDwYJKoZIhvdjZAY6BAIFADANBgkqhkiG9w0BAQsFAAOCAQEAraCEPzWc+wYnSGKfKKqmYINigx0vXEdpJxLabUjSr4vfgBeaDqTMtgpSMOXaKCkq+y9GJ7BOv5spvYJs3+ml5b87nRjMxAAq1XjGGfGCh3P+UL4HVDQCK4tnQO9FWUZP2sTGLUiHTFUIdLNwwQYsJrVPrp0KPznCVr/3lwX9OfWSsQywwuLF1EmzNDR2oat8pATyS4U5A193WtxyLNkpBOSmkfJ3G9sFEQfhJSfANGfeeixrTLzBF+x9J29tKiUxgaPb4xlYLKFPR2Al3SEC/hbVx9R4ZEqML4UxaFc8OvXdW5roAnuB66cWnqMXfaYGzjxGrBFESqmraKSkSDw4kzCCBEQwggMsoAMCAQICCFxjyuRKN1PJMA0GCSqGSIb3DQEBCwUAMGIxCzAJBgNVBAYTAlVTMRMwEQYDVQQKEwpBcHBsZSBJbmMuMSYwJAYDVQQLEx1BcHBsZSBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTEWMBQGA1UEAxMNQXBwbGUgUm9vdCBDQTAeFw0xNzA1MTAyMTI3MzBaFw0zMDEyMzEwMDAwMDBaMHMxLTArBgNVBAMMJEFwcGxlIGlQaG9uZSBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTEgMB4GA1UECwwXQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkxEzARBgNVBAoMCkFwcGxlIEluYy4xCzAJBgNVBAYTAlVTMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAyUVqAQ8+gwSGx/y/3F7wHoHuFzBzYyYu3j16JM2TPk85R7p1vvPA0vFZoqsf/gqGPNktmgfyDmu5KZEaXyIKi/FyWAWuTEtExXmngDywiOCMDCeEXRnlhxk2y+PFdrew9EFyUfQFXINLom2mUbjxJt97Xq1lDMaymFGMu30bTMFOyAjH0u1kC7TdG41PQH0bj0iWklvz0Jh+2bykGQ6ZYbtBXQHMW3d6fSTQ3NNT/8PcxZQstlpNjhgjOb3ZxlI+0fL0JYqhKof92AxGKVH/7RdsiSVrh7+KaRSfd5/DFbdos4hFvYTmBgJBZA+tKii4FcngrKeKunIENLJ4jPiyhQIDAQABo4HsMIHpMA8GA1UdEwEB/wQFMAMBAf8wHwYDVR0jBBgwFoAUK9BpR5R2Cf70a40uQKb3R01/CF4wRAYIKwYBBQUHAQEEODA2MDQGCCsGAQUFBzABhihodHRwOi8vb2NzcC5hcHBsZS5jb20vb2NzcDAzLWFwcGxlcm9vdGNhMC4GA1UdHwQnMCUwI6AhoB+GHWh0dHA6Ly9jcmwuYXBwbGUuY29tL3Jvb3QuY3JsMB0GA1UdDgQWBBRv8ZUYYlzgyPHF7WwYyeDTZFKYIDAOBgNVHQ8BAf8EBAMCAQYwEAYKKoZIhvdjZAYCEgQCBQAwDQYJKoZIhvcNAQELBQADggEBADrPrJiNvpIgIQmtlfOxXCH6Ni1XIER0c2SSCLOWrPdtl/pbNDgnzxJG0zwR8AfJmZCx0egRCaXjpWtsYwg/niX61ZmcTOblzo6yTWjsi6ujok+KERU+3BQrHMZEtm9nxVtPlSkth1w/3IMed0/t2lSnLecTgcFjxFQLG0sKaigiCNQ3knx/Zyhfrz0/t6xZHTg0ZFruM0oZQkQpxMoYa+HBUy0t9E3CFfYzMhh48SZvik3rlEyj6P8PswOLZdrrLthlUJ/cn4rfMaiEVNxSUkHSshMdMUZHiF8+7sPyjCMEleusij6CbAafLuOLQ5piWzQN9JnPLO66coYZI6X8jrUwggS7MIIDo6ADAgECAgECMA0GCSqGSIb3DQEBBQUAMGIxCzAJBgNVBAYTAlVTMRMwEQYDVQQKEwpBcHBsZSBJbmMuMSYwJAYDVQQLEx1BcHBsZSBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTEWMBQGA1UEAxMNQXBwbGUgUm9vdCBDQTAeFw0wNjA0MjUyMTQwMzZaFw0zNTAyMDkyMTQwMzZaMGIxCzAJBgNVBAYTAlVTMRMwEQYDVQQKEwpBcHBsZSBJbmMuMSYwJAYDVQQLEx1BcHBsZSBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTEWMBQGA1UEAxMNQXBwbGUgUm9vdCBDQTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAOSRqQkfkdseR1DrBe1eeYQt6zaiV0xV7IsZid75S2z1B6siMALoGD74UAnTf0GomPnRymacJGsR0KO75Bsqwx+VnnoMpEeLW9QWNzPLxA9NzhRp0ckZcvVdDtV/X5vyJQO6VY9NXQ3xZDUjFUsVWR2zlPf2nJ7PULrBWFBnjwi0IPfLrCwgb3C2PwEwjLdDzw+dPfMrSSgayP7OtbkO2V4c1ss9tTqt9A8OAJILsSEWLnTVPA3bYharo3GSR1NVwa8vQbP4++NwzeajTEV+H0xrUJZBicR0YgsQg0GHM4qBsTBY7FoEMoxos48d3mVz/2deZbxJ2HafMxRloXeUyS0CAwEAAaOCAXowggF2MA4GA1UdDwEB/wQEAwIBBjAPBgNVHRMBAf8EBTADAQH/MB0GA1UdDgQWBBQr0GlHlHYJ/vRrjS5ApvdHTX8IXjAfBgNVHSMEGDAWgBQr0GlHlHYJ/vRrjS5ApvdHTX8IXjCCAREGA1UdIASCAQgwggEEMIIBAAYJKoZIhvdjZAUBMIHyMCoGCCsGAQUFBwIBFh5odHRwczovL3d3dy5hcHBsZS5jb20vYXBwbGVjYS8wgcMGCCsGAQUFBwICMIG2GoGzUmVsaWFuY2Ugb24gdGhpcyBjZXJ0aWZpY2F0ZSBieSBhbnkgcGFydHkgYXNzdW1lcyBhY2NlcHRhbmNlIG9mIHRoZSB0aGVuIGFwcGxpY2FibGUgc3RhbmRhcmQgdGVybXMgYW5kIGNvbmRpdGlvbnMgb2YgdXNlLCBjZXJ0aWZpY2F0ZSBwb2xpY3kgYW5kIGNlcnRpZmljYXRpb24gcHJhY3RpY2Ugc3RhdGVtZW50cy4wDQYJKoZIhvcNAQEFBQADggEBAFw2mUwteLftjJvc83eb8nbSdzBPwR+Fg4UbmT1HN/Kpm0COLNSxkBLYvvRzm+7SZA/LeU802KI++Xj/a8gH7H05g4tTINM4xLG/mk8Ka/8r/FmnBQl8F0BWER5007eLIztHo9VvJOLr0bdw3w9F4SfK8W147ee1Fxeo3H4iNcol1dkP1mvUoiQjEfehrI9zgWDGG1sJL5Ky+ERI8GA4nhX1PSZnIIozavcNgs/e66Mv+VNqW2TAYzN39zoHLFbr2g8hDtq6cxlPtdk2f8GHVdmnmbkyQvvY1XGefqFStxu9k0IkEirHDx22TZxeY8hLgBdQqorV2uT80AkHN7B1dSExggKFMIICgQIBATB/MHMxLTArBgNVBAMMJEFwcGxlIGlQaG9uZSBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTEgMB4GA1UECwwXQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkxEzARBgNVBAoMCkFwcGxlIEluYy4xCzAJBgNVBAYTAlVTAghj5xwhnRqTJzAJBgUrDgMCGgUAoIHcMBgGCSqGSIb3DQEJAzELBgkqhkiG9w0BBwEwHAYJKoZIhvcNAQkFMQ8XDTIyMTAxMzIzMDQ1MVowIwYJKoZIhvcNAQkEMRYEFDIGV9BffMc5AAvUWWakelDStwBcMCkGCSqGSIb3DQEJNDEcMBowCQYFKw4DAhoFAKENBgkqhkiG9w0BAQEFADBSBgkqhkiG9w0BCQ8xRTBDMAoGCCqGSIb3DQMHMA4GCCqGSIb3DQMCAgIAgDANBggqhkiG9w0DAgIBQDAHBgUrDgMCBzANBggqhkiG9w0DAgIBKDANBgkqhkiG9w0BAQEFAASCAQCSGyZ8ZZ0BRJXYIislNogISZNXvdtq1aFeLVvA0O4kBORwfbkAmmDpf9/73HRzd3pmQpSho9U3I82mTo6oxBPiy5mdLQ1v/VQLs7KRe2DpGKT/R+9SvWmruGRT2A2WStZS1XGo2rEVrYF8m5cT6SGRp0RkmOShEOczaehjWBoEITiwTybnjaVj8AcI5y0ZjQ44Y1T8GTfItmMqCuIvTCwyn36pwzZDEW6824bwzAoHS8yU4iBYYljHkBNx94v2Y8C818nuHAzdWy0p3GQ7tEV8VUx8dqXZJjgJF/WbZ+9hrdRZWH9QaUfhnEYdaZtWIgT07DElHHR6e3VGdwNzobPg
          KEYCHAIN_PASSWORD: 7362
        run: |
          # create variables
          CERTIFICATE_PATH=$RUNNER_TEMP/build_certificate.p12
          PP_PATH=$RUNNER_TEMP/build_pp.mobileprovision
          KEYCHAIN_PATH=$RUNNER_TEMP/app-signing.keychain-db

          # import certificate and provisioning profile from secrets
          echo -n "$BUILD_CERTIFICATE_BASE64" | base64 --decode --output $CERTIFICATE_PATH
          echo -n "$BUILD_PROVISION_PROFILE_BASE64" | base64 --decode --output $PP_PATH

          # create temporary keychain
          security create-keychain -p "$KEYCHAIN_PASSWORD" $KEYCHAIN_PATH
          security set-keychain-settings -lut 21600 $KEYCHAIN_PATH
          security unlock-keychain -p "$KEYCHAIN_PASSWORD" $KEYCHAIN_PATH

          # import certificate to keychain
          security import $CERTIFICATE_PATH -P "$P12_PASSWORD" -A -t cert -f pkcs12 -k $KEYCHAIN_PATH
          security list-keychain -d user -s $KEYCHAIN_PATH

          # apply provisioning profile
          mkdir -p ~/Library/MobileDevice/Provisioning\ Profiles
          cp $PP_PATH ~/Library/MobileDevice/Provisioning\ Profiles
      - name: Build
        run: flutter build ios --release --no-codesign
      - name: Build resolve Swift dependencies
        run: xcodebuild -resolvePackageDependencies -workspace ios/Runner.xcworkspace -scheme Runner -configuration "Release"
      - name: Build xArchive
        run: |
          xcodebuild -workspace ios/Runner.xcworkspace -scheme Runner -configuration "Release-staging" DEVELOPMENT_TEAM=4548NWFTN8 -sdk 'iphoneos' -destination 'generic/platform=iOS' -archivePath build/app.xcarchive PROVISIONING_PROFILE=00008030-000270243679802E -allowProvisioningUpdates
      - name: Export ipa
        run: |
          xcodebuild -exportArchive -archivePath build-output/app.xcarchive -exportPath build-output/ios -exportOptionsPlist ExportOptions.plist
      - name: Archive Production Artifact
        uses: actions/upload-artifact@v3
        with:
          name: App.ipa
          path: /Users/runner/work/YOUR_APP/YOUR_APP/app/build-output/ios/ipa/carte_crm_test.ipa

  deploy:
    name: Deploy app
    needs: build
    runs-on: ubuntu-latest
    steps:
      - uses: actions/download-artifact@v3
        with:
          name: ios_build
      - uses: actions/setup-node@v3
        with:
          node-version: 16
      - name: Upload IPA
        uses: wzieba/Firebase-Distribution-Github-Action@master
        with:
          appId: 1:420295022617:ios:a8368f9757aec30e4d3288
          token: 1//069zeH2EL8NWICgYIARAAGAYSNwF-L9IrWy9_03-PKJVkSJyV1zAoSmkZKoLlecYkqXcQedU1EshrwoBW7jCFX5t78aosc8QhONA
          groups: testers
          file: Runner.ipa
